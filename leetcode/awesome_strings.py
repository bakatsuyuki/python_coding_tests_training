import numpy as np
from line_profiler_pycharm import profile


class Solution:
    @profile
    def longestAwesome(self, s: str) -> int:
        all_numbers_counts = [0] * 10
        len_s = len(s)
        dp = np.zeros((len_s, 10), dtype=int)
        min_result = 0
        for i in range(len_s):
            s_child = int(s[i])
            all_numbers_counts[s_child] += 1
            if i > 0:
                dp[i] = dp[i - 1]
            dp[i][s_child] += 1
            if self.oddCount(dp[i]) < 2:
                min_result = i + 1
        for i in range(len_s):
            if len_s - i - 1 < min_result:
                break
            j = len_s - 1
            while j - i >= min_result:
                odd_count = self.oddCount(dp[j] - dp[i])
                if odd_count < 2:
                    min_result = j - i
                    break
                else:
                    j -= odd_count - 1
        return min_result

    def oddCount(self, occurrences):
        return np.count_nonzero(occurrences % 2)


print(Solution().longestAwesome(
    '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'))
